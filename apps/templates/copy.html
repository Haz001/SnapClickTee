<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Overlay</title>
    <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
</head>
<body>
    <!-- // this works but need to press qr code -->

    <!-- <input type="file" id="file_input" accept="image/*" style="display: none;"> Hidden file input -->

    <img src="static/img/neom-hgf0fJGJPQs-unsplash.jpg" id="image_input" style="width: 700px; height: 700px;"/>

    <a id="generate_button" class="btn align-right" href="#">Generate QR Code</a>
    
    <canvas id="canvas"></canvas> <!-- Canvas for QR code and image -->

    <script>
        // Define the button and image variables
        const generateButton = document.getElementById('generate_button');
        // const fileInput = document.getElementById('file_input');
        const imageInput = document.getElementById('image_input');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const qrCodeSize = 200; // Size of the QR code square
        
        // Add a click handler to the button
        generateButton.addEventListener('click', () => {
            if (!imageInput.src) {
                alert('Please select an image.');
            }


            const qrCodeData = "https://example.com"; // Replace with your QR code data
            // const imageFile = selectedImage;
            
            // Create a new QRCode instance
            const qrcode = new QRCode(canvas, {
                text: qrCodeData,
                width: qrCodeSize,
                height: qrCodeSize,
            });

            // Load the selected image
            const img = new Image();
            img.src = imageInput.src;

            img.onload = () => {
                // Draw the image on the canvas
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.drawImage(img, 0, 0, img.width, img.height);

                // Draw the QR code on top of the image
                ctx.drawImage(qrcode._el.lastChild, img.width - qrCodeSize, 0, qrCodeSize, qrCodeSize);
            };
            // img.src = imageInput.src;
            // img.src = URL.createObjectURL(imageFile);
            // img.src = URL.createObjectURL(imageInput);
            // if (selectedImage instanceof File) {
            //     img.src = URL.createObjectURL(selectedImage);
            // } else if (selectedImage instanceof HTMLImageElement) {
            //     img.src = selectedImage.src;
            // } else {
            //     alert('No image selected.');
        // }
        });
    </script>
</body>
</html>
